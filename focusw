#!/bin/sh
# focus wrapper that sets borders and can focus next/previous window

a=0xb8b8c8 # active border color
i=0x1a1a26 # inactive border color

# get current window id
c=$(pfw)

setborder() {
	r=$(lsw -r)

	# check if window exists
	wattr $2 || return

	# do not modify border of fullscreen windows
	test "$(wattr xywh $2)" = "$(wattr xywh $r)" && return

	case $1 in
		active)   chwb -s$BORDERWIDTH -c$a $2 ;;
		inactive) chwb -s$BORDERWIDTH -c$i $2 ;;
	esac
}

case $1 in
	next) wid=$(lsw|grep -v $c|sed '1 p;d') ;;
	prev) wid=$(lsw|grep -v $c|sed '$ p;d') ;;
	0x*) wattr $1 && wid=$1 ;;
esac

# exit if another window to focus can't be found
test -z "$wid" && echo "can't find a window to focus" >&2 && exit 1

# set inactive border on current window
setborder inactive $c
# activate the new window
setborder active $wid
# put it on top of the stack
chwso -r $wid
# set focus on it
wtf $wid
